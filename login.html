<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ROBOSTREAKS CLUB | Portal</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Merriweather:ital,wght@0,700;1,400&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'], 
                        serif: ['Merriweather', 'serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        brand: {
                            50: '#f0f9ff', 100: '#e0f2fe', 500: '#0ea5e9', 600: '#0284c7', 900: '#0c4a6e',
                        },
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #f8fafc;
            font-family: 'Inter', sans-serif;
            /* Technical Grid Background */
            background-image: 
                radial-gradient(#e2e8f0 1.5px, transparent 1.5px),
                linear-gradient(to right, rgba(241, 245, 249, 0.6) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(241, 245, 249, 0.6) 1px, transparent 1px);
            background-size: 24px 24px, 96px 96px, 96px 96px;
            background-attachment: fixed;
            overflow: hidden;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* Text selection color */
        ::selection { background-color: #dbeafe; color: #1e3a8a; }

        /* FIX: CSS-only focus/active styles for better mobile keyboard behavior */
        .input-group:focus-within {
            border-color: #3b82f6; /* blue-500 */
            --tw-ring-color: #3b82f6;
            --tw-ring-opacity: 0.1;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1); /* ring-4 ring-blue-500/10 */
            background-color: white;
        }
        .input-group:focus-within .input-icon {
            color: #2563eb; /* text-blue-600 */
        }
    </style>
<link rel="stylesheet" href="/index.css">
</head>
<body class="bg-slate-50 text-slate-900 font-sans h-screen flex flex-col">

    <div id="app" class="flex-1 flex flex-col h-full overflow-hidden"></div>

    <script>
        // --- DATA ---
        const MOCK_MEMBERS = [
            { id: '001', name: 'Pabitra Khandual', email: 'P', password: 'p', role: 'MEMBER', branch: 'Chemical Engineering', regNo: '25CHE21', joinedDate: '2025-09-01', mobile: '7064074428' },
            { id: '002', name: 'Bob Smith', email: 'bob@edu.com', password: 'bobpass', role: 'MEMBER', branch: 'Mech Eng', regNo: 'ME2025042', joinedDate: '2023-09-15', mobile: '+1 (555) 234-5678' },
            { id: '003', name: 'Charlie Davis', email: 'charlie@edu.com', password: 'charliepass', role: 'MEMBER', branch: 'Electronics', regNo: 'EC2025103', joinedDate: '2024-01-12', mobile: '+1 (555) 345-6789' },
            { id: '004', name: 'Diana Prince', email: 'diana@edu.com', password: 'dianapass', role: 'MEMBER', branch: 'Civil Eng', regNo: 'CE2025088', joinedDate: '2023-11-30', mobile: '+1 (555) 456-7890' },
        ];

        const ADMIN_USER = { 
            id: 'admin-1', 
            name: 'System Admin', 
            email: 'a', 
            password: 'a',
            role: 'ADMIN', 
            mobile: 'ADMIN' 
        };

        const MOCK_ANNOUNCEMENTS = [
            { id: 1, type: 'URGENT', title: 'Lab Access Restricted', description: 'Main robotics lab will be closed for maintenance this Saturday due to electrical upgrades.', date: 'Today' },
            { id: 2, type: 'EVENT', title: 'RoboWars 2025 Registration', description: 'Team registrations are now open. Form teams of 3-4 members and register before Friday.', date: 'Yesterday' },
            { id: 3, type: 'INFO', title: 'New 3D Printers Available', description: 'Three new Bambu Lab printers have been installed in Lab B. Please complete the safety orientation.', date: 'Oct 24' },
        ];

        // --- STATE MANAGEMENT ---
        const state = {
            view: 'LOGIN', // 'LOGIN' or 'DASHBOARD'
            user: null,
            mounted: false,
            login: {
                role: 'MEMBER',
                email: '',
                password: '',
                loading: false,
                error: '',
                // FIX: focusedField is no longer strictly needed for this logic, but keeping it for other potential uses.
                focusedField: ''
            },
            admin: {
                search: '',
                selectedIds: []
            }
        };

        // --- ACTIONS ---
        window.actions = {
            setLoginRole: (role) => {
                state.login.role = role;
                state.login.error = '';
                // Optional: Clear inputs on role change or keep them
                state.login.email = '';
                state.login.password = '';
                render();
            },
            
            updateLoginField: (field, val) => { 
                state.login[field] = val; 
            },

            // FIX: Removed render() call here to stop disrupting native focus flow
            setFocus: (field) => { 
                state.login.focusedField = field;
                // render(); // <-- REMOVED: Do not re-render on every focus/blur.

                // If you must set the selection range (cursor position), 
                // you can keep this part, but it's not strictly needed for the fix.
                if (field) {
                    const el = document.getElementById(`input-${field}`);
                    if(el) {
                        const len = el.value.length;
                        el.setSelectionRange(len, len);
                    }
                }
            },
            
            handleLogin: (e) => {
                e.preventDefault();
                state.login.loading = true;
                state.login.error = '';
                render();

                setTimeout(() => {
                    state.login.loading = false;
                    const { role, email, password } = state.login; 
                    let authenticatedUser = null;

                    if (role === 'ADMIN' && email === ADMIN_USER.email && password === ADMIN_USER.password) {
                        authenticatedUser = ADMIN_USER;
                    } else if (role === 'MEMBER') {
                        
                        const foundMember = MOCK_MEMBERS.find(m => m.email === email || m.regNo === email);
                        if (foundMember && password === foundMember.password) { 
                            authenticatedUser = foundMember;
                        }
                    }

                    if (authenticatedUser) {
                        state.user = authenticatedUser;
                        state.view = 'DASHBOARD';
                    } else {
                        state.login.error = 'Invalid credentials. Please verify your access details.';
                    }

                    render();
                }, 800);
            },
            
            logout: () => {
                state.user = null;
                state.view = 'LOGIN';
                state.login.email = '';
                state.login.password = '';
                state.admin.selectedIds = [];
                state.admin.search = '';
                state.mounted = false; 
                render();
                setTimeout(() => {
                    state.mounted = true;
                    render();
                }, 10);
            },

            searchAdmin: (val) => {
                state.admin.search = val;
                render();
                const input = document.getElementById('search-input');
                if(input) {
                    input.focus();
                    input.value = val; 
                    input.setSelectionRange(val.length, val.length);
                }
            },

            toggleSelect: (id) => {
                const idx = state.admin.selectedIds.indexOf(id);
                if (idx > -1) {
                    state.admin.selectedIds.splice(idx, 1);
                } else {
                    state.admin.selectedIds.push(id);
                }
                render();
            },

            toggleSelectAll: () => {
                const filtered = getFilteredMembers();
                const allSelected = filtered.length > 0 && filtered.every(m => state.admin.selectedIds.includes(m.id));

                if (allSelected) {
                    const visibleIds = filtered.map(m => m.id);
                    state.admin.selectedIds = state.admin.selectedIds.filter(id => !visibleIds.includes(id));
                } else {
                    filtered.forEach(m => {
                        if(!state.admin.selectedIds.includes(m.id)) state.admin.selectedIds.push(m.id);
                    });
                }
                render();
            },

            handleBulkMail: () => {
                const selectedEmails = MOCK_MEMBERS
                    .filter(m => state.admin.selectedIds.includes(m.id))
                    .map(m => m.email);
                
                if (selectedEmails.length > 0) {
                    window.location.href = `mailto:${selectedEmails.join(',')}`;
                }
            }
        };

        // Helper
        function getFilteredMembers() {
            const searchLower = state.admin.search.toLowerCase();
            return MOCK_MEMBERS.filter(m => 
                m.name.toLowerCase().includes(searchLower) || 
                m.email.toLowerCase().includes(searchLower) || 
                (m.regNo && m.regNo.toLowerCase().includes(searchLower))
            );
        }

        // --- RENDER ENGINE ---
        const app = document.getElementById('app');

        function render() {
            // Build HTML String
            let html = '';
            if (state.view === 'LOGIN') {
                html = LoginView();
            } else {
                html = AppLayout(state.user.role === 'ADMIN' ? AdminDashboardView() : MemberDashboardView());
            }
            
            app.innerHTML = html;

            // --- POST-RENDER EFFECTS ---
            // Initialize Lucide icons
            if (window.lucide) {
                window.lucide.createIcons();
            }
        }

        // Start animation on load
        setTimeout(() => {
            state.mounted = true;
            render();
        }, 100);

        // --- COMPONENT TEMPLATES ---

        // 1. LOGIN VIEW
        function LoginView() {
            const { role, loading, error, email, password } = state.login;
            const { mounted } = state;
            
            return `
            <div class="min-h-screen flex w-full bg-slate-50 font-sans overflow-hidden">
                <div class="hidden lg:flex w-5/12 bg-slate-950 relative flex-col justify-between p-12 text-white border-r border-slate-900">
                    <div class="absolute inset-0 overflow-hidden">
                        <div class="absolute inset-0 opacity-20" style="background-image: radial-gradient(#4f46e5 1px, transparent 1px); background-size: 40px 40px;"></div>
                        <div class="absolute top-0 right-0 w-[600px] h-[600px] bg-blue-600/20 rounded-full blur-[120px] -translate-y-1/2 translate-x-1/2 mix-blend-screen animate-pulse-slow"></div>
                        <div class="absolute bottom-0 left-0 w-[500px] h-[500px] bg-indigo-600/10 rounded-full blur-[100px] translate-y-1/3 -translate-x-1/4 mix-blend-screen"></div>
                    </div>

                    <div class="relative z-10 flex flex-col h-full justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-gradient-to-tr from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/20 border border-white/10">
                                <i data-lucide="bot" class="w-6 h-6 text-white"></i>
                            </div>
                            <div>
                                <h1 class="font-bold tracking-[0.2em] text-sm text-white uppercase leading-none mb-1">Robostreaks</h1>
                                <p class="text-[10px] text-slate-400 font-mono tracking-wider">SECURE ACCESS PORTAL</p>
                            </div>
                        </div>

                        <div class="transition-all duration-1000 transform ${mounted ? 'translate-y-0 opacity-100' : 'translate-y-10 opacity-0'}">
                            <div class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-900/50 border border-slate-700/50 backdrop-blur-md text-emerald-400 text-[10px] font-mono font-bold uppercase tracking-wider mb-8 shadow-sm">
                                <span class="relative flex h-2 w-2">
                                  <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                                  <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                                </span>
                                <span>System Operational</span>
                            </div>
                            
                            <h2 class="text-5xl xl:text-6xl font-extrabold leading-tight mb-6 tracking-tight">
                                Build the <br/>
                                <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-indigo-400 to-purple-400">Future.</span>
                            </h2>
                            <p class="text-slate-400 text-lg leading-relaxed max-w-md border-l-2 border-indigo-500/50 pl-6">
                                Manage robotics projects, reserve high-precision lab equipment, and collaborate with engineering teams in real-time.
                            </p>
                        </div>

                        <div class="grid grid-cols-2 gap-8 border-t border-slate-800/60 pt-8">
                            <div>
                                <div class="flex items-center gap-2 mb-2 text-slate-400">
                                    <i data-lucide="cpu" class="w-4 h-4"></i>
                                    <span class="text-xs font-bold uppercase tracking-wider">Lab Resource</span>
                                </div>
                                <div class="text-2xl font-mono font-bold text-white">84%</div>
                                <div class="text-[10px] text-slate-500 mt-1">Availability</div>
                            </div>
                            <div>
                                <div class="flex items-center gap-2 mb-2 text-slate-400">
                                    <i data-lucide="terminal" class="w-4 h-4"></i>
                                    <span class="text-xs font-bold uppercase tracking-wider">Active Nodes</span>
                                </div>
                                <div class="text-2xl font-mono font-bold text-white">${MOCK_MEMBERS.length}</div>
                                <div class="text-[10px] text-slate-500 mt-1">Registered Users</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="w-full lg:w-7/12 flex items-center justify-center p-4 sm:p-8 bg-slate-50 relative">
                    <div class="absolute inset-0 opacity-[0.4]" style="background-image: radial-gradient(#cbd5e1 1px, transparent 1px); background-size: 24px 24px;"></div>

                    <div class="max-w-[440px] w-full relative z-10 flex flex-col transition-all duration-700 delay-200 ${mounted ? 'translate-y-0 opacity-100' : 'translate-y-4 opacity-0'}">
                        
                        <div class="lg:hidden flex justify-center mb-8">
                            <div class="w-12 h-12 bg-slate-900 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/20">
                                <i data-lucide="bot" class="w-6 h-6 text-white"></i>
                            </div>
                        </div>

                        <div class="text-center mb-8 lg:text-left">
                            <h2 class="text-3xl font-extrabold text-slate-900 tracking-tight">ROBOSTREAKS</h2>
                             
                        </div>

                        <div class="bg-white p-6 sm:p-8 rounded-2xl shadow-2xl shadow-slate-200/50 border border-slate-100 relative overflow-hidden ring-4 ring-blue-500/30">
                        
                            <div class="flex p-1 bg-slate-100 rounded-xl mb-8 relative">
                                <div class="absolute top-1 bottom-1 w-[calc(50%-4px)] bg-white rounded-lg shadow-md border border-slate-200 transition-all duration-300 ease-out ${role === 'ADMIN' ? 'translate-x-[calc(100%+4px)]' : 'translate-x-0'}"></div>
                                <button onclick="actions.setLoginRole('MEMBER')" type="button" class="flex-1 relative z-10 text-xs font-bold py-2.5 rounded-lg flex items-center justify-center gap-2 transition-colors duration-300 ${role === 'MEMBER' ? 'text-blue-700' : 'text-slate-500 hover:text-slate-700'}">
                                    <i data-lucide="users" class="w-3 h-3 ${role === 'MEMBER' ? 'text-blue-500' : 'text-slate-400'}"></i>
                                    Member
                                </button>
                                <button onclick="actions.setLoginRole('ADMIN')" type="button" class="flex-1 relative z-10 text-xs font-bold py-2.5 rounded-lg flex items-center justify-center gap-2 transition-colors duration-300 ${role === 'ADMIN' ? 'text-indigo-700' : 'text-slate-500 hover:text-slate-700'}">
                                    <i data-lucide="shield" class="w-3 h-3 ${role === 'ADMIN' ? 'text-indigo-500' : 'text-slate-400'}"></i>
                                    Admin
                                </button>
                            </div>

                            <form onsubmit="actions.handleLogin(event)" class="space-y-5">
                                <div class="space-y-1.5">
                                    <label class="text-[11px] font-bold text-slate-700 uppercase tracking-wide ml-1">Email / Reg. No</label>
                                    <div class="relative group transition-all duration-300 bg-slate-50 border rounded-xl overflow-hidden input-group border-slate-200 hover:border-slate-300">
                                        <div class="absolute left-0 top-0 bottom-0 w-12 flex items-center justify-center border-r border-slate-100 bg-slate-100/50">
                                            <i data-lucide="user" class="w-4 h-4 transition-colors text-slate-400 input-icon"></i>
                                        </div>
                                        <input type="text" id="input-email" required
                                            value="${email}" 
                                            oninput="actions.updateLoginField('email', this.value)"
                                            class="w-full pl-14 pr-4 py-3 bg-transparent focus:outline-none text-sm font-medium text-slate-900 placeholder:text-slate-400"
                                            placeholder="Your Email or Registration Number" />
                                    </div>
                                </div>

                                <div class="space-y-1.5">
                                    <div class="flex justify-between ml-1">
                                        <label class="text-[11px] font-bold text-slate-700 uppercase tracking-wide">Password</label>
                                    </div>
                                    <div class="relative group transition-all duration-300 bg-slate-50 border rounded-xl overflow-hidden input-group border-slate-200 hover:border-slate-300">
                                        <div class="absolute left-0 top-0 bottom-0 w-12 flex items-center justify-center border-r border-slate-100 bg-slate-100/50">
                                            <i data-lucide="lock" class="w-4 h-4 transition-colors text-slate-400 input-icon"></i>
                                        </div>
                                        <input type="password" id="input-password" required
                                            value="${password}"
                                            oninput="actions.updateLoginField('password', this.value)"
                                            class="w-full pl-14 pr-4 py-3 bg-transparent focus:outline-none text-sm font-medium text-slate-900 placeholder:text-slate-400"
                                            placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
                                    </div>
                                </div>

                                ${error ? `<div class="p-3 bg-red-50 text-red-600 text-xs font-semibold rounded-lg border border-red-100 flex items-center gap-2 animate-fade-in"><i data-lucide="alert-triangle" class="w-4 h-4 shrink-0"></i> ${error}</div>` : ''}

                                <button type="submit" ${loading ? 'disabled' : ''}
                                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3.5 rounded-xl shadow-xl shadow-blue-600/20 hover:shadow-blue-600/30 transition-all flex items-center justify-center gap-2 group disabled:opacity-70 disabled:shadow-none translate-y-0 hover:-translate-y-0.5 active:translate-y-0">
                                    ${loading ? 
                                        `<span class="flex items-center gap-2 text-blue-200"><span class="w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"></span> Authenticating...</span>` : 
                                        ` LOGIN <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>`
                                    }
                                </button>
                            </form>
                        </div>
                        
                        <div class="mt-8 text-center">
                             <p class="text-[10px] text-slate-400 font-medium">By accessing this system, you agree to the <a href="#" class="underline hover:text-slate-600">Lab Safety Protocols</a>.</p>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        // 2. MAIN LAYOUT
        function AppLayout(content) {
            const user = state.user;
            const initials = user.name.charAt(0).toUpperCase();

            return `
            <div class="min-h-screen flex flex-col bg-transparent text-slate-900 font-sans">
                <header class="sticky top-0 z-30 bg-white/80 backdrop-blur-xl border-b border-slate-200/80 h-16 shadow-sm">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 h-full flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-9 h-9 bg-slate-900 rounded-lg flex items-center justify-center text-blue-400 shadow-md shadow-blue-900/10 shrink-0">
                                <i data-lucide="bot" class="w-5 h-5"></i>
                            </div>
                            <div class="flex flex-col">
                                <span class="font-extrabold text-lg tracking-tight text-slate-900 leading-none">ROBOSTREAKS</span>
                                <span class="text-[10px] font-mono font-medium text-slate-500 tracking-wider uppercase">Learn. Innovate. Excel.</span>
                            </div>
                        </div>

                        <div class="flex items-center gap-4">
                            <div class="flex items-center gap-3 pl-4 sm:border-l border-slate-200 h-8">
                                <div class="text-right hidden sm:block">
                                    <p class="text-xs font-bold text-slate-800 leading-tight">${user.name}</p>
                                    <p class="text-[9px] font-mono font-semibold text-blue-600 uppercase tracking-wide mt-0.5">${user.role}</p>
                                </div>
                                <div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center text-white text-xs font-bold shadow-md ring-2 ring-white">
                                    ${initials}
                                </div>
                            </div>
                            <button onclick="actions.logout()" class="p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 border border-transparent hover:border-red-100" title="Sign Out">
                                <i data-lucide="log-out" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                </header>

                <main class="flex-1 p-4 md:p-8 overflow-y-auto scroll-smooth">
                    <div class="max-w-7xl mx-auto w-full">
                        ${content}
                    </div>
                </main>
            </div>`;
        }

        // 3. MEMBER DASHBOARD
        function MemberDashboardView() {
            const user = state.user;
            
            return `
            <div class="space-y-6 animate-fade-in pb-6">
                <div class="flex flex-col md:flex-row md:items-end justify-between gap-4">
                    <div>
                        <div class="flex items-center gap-2 text-slate-400 text-xs font-mono mb-1 uppercase tracking-wider">
                            <i data-lucide="activity" class="w-3 h-3 text-green-500"></i>
                            <span>${new Date().toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' })}</span>
                        </div>
                        <h1 class="text-2xl font-bold text-slate-900 tracking-tight">Hello, ${user.name} ðŸ‘‹</h1>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
                    <div class="lg:col-span-5 flex flex-col gap-6">
                        <div class="bg-white/50 backdrop-blur-sm rounded-2xl p-1">
                             ${IDCard(user)}
                        </div>
                        
                    </div>

                    <div class="lg:col-span-7">
                        <div class="bg-white border border-slate-200/80 rounded-2xl shadow-xl shadow-slate-200/40 overflow-hidden flex flex-col">
                            <div class="px-6 py-5 border-b border-slate-100 flex justify-between items-center bg-white">
                                <h2 class="font-bold text-sm text-slate-800 flex items-center gap-2 uppercase tracking-wide">
                                    <i data-lucide="bell-ring" class="w-4 h-4 text-blue-600"></i>
                                    Club Announcements
                                </h2>
                                <span class="flex h-2 w-2 relative">
                                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span>
                                    <span class="relative inline-flex rounded-full h-2 w-2 bg-blue-500"></span>
                                </span>
                            </div>

                            <div class="divide-y divide-slate-50">
                                ${MOCK_ANNOUNCEMENTS.map(item => `
                                    <div class="p-6 hover:bg-slate-50/80 transition-all duration-200 group relative border-l-2 border-transparent hover:border-blue-500 cursor-pointer">
                                        <div class="flex flex-col sm:flex-row sm:items-start justify-between gap-2 mb-2">
                                            <div class="flex items-center gap-3">
                                                <span class="text-[9px] font-mono font-bold px-2 py-0.5 rounded border uppercase tracking-wider ${
                                                    item.type === 'URGENT' ? 'bg-red-50 text-red-600 border-red-200' : 
                                                    item.type === 'EVENT' ? 'bg-purple-50 text-purple-600 border-purple-200' : 
                                                    'bg-blue-50 text-blue-600 border-blue-200'
                                                }">
                                                    ${item.type}
                                                </span>
                                                <span class="text-[10px] text-slate-400 font-mono flex items-center gap-1">
                                                    <i data-lucide="calendar" class="w-3 h-3"></i> ${item.date}
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <div class="pr-8">
                                            <h3 class="text-base font-bold text-slate-900 mb-1.5 group-hover:text-blue-600 transition-colors">${item.title}</h3>
                                            <p class="text-sm text-slate-600 leading-relaxed">${item.description}</p>
                                        </div>
                                        
                                        <i data-lucide="chevron-right" class="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-200 group-hover:text-blue-400 group-hover:translate-x-1 transition-all"></i>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        // 4. ID CARD COMPONENT 
        function IDCard(user) {
            const initial = user.name.charAt(0).toUpperCase();

            return `
            <div class="flex flex-col items-center gap- w-full max-w-md mx-auto py-2">
                <div class="relative w-[340px] h-[260px] sm:w-[420px] sm:h-[255px]">
                    <div class="absolute inset-0 w-full h-full bg-white rounded-xl shadow-2xl shadow-blue-500/20 overflow-hidden border border-slate-300 flex flex-col">
                        <div class="h-4 w-full bg-gradient-to-r from-blue-700 via-indigo-700 to-purple-700"></div>
                        
                        <div class="flex-1 p-6 relative flex flex-col">
                            <div class="flex justify-between items-start mb-4 relative z-10">
                                <div class="flex items-center gap-4">
                                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-slate-900 to-slate-700 flex items-center justify-center text-blue-400 shadow-xl">
                                        <i data-lucide="bot" class="w-5 h-5"></i>
                                    </div>
                                    <div class="flex flex-col">
                                        <h3 class="font-extrabold text-slate-900 text-sm tracking-[0.1em] leading-none flex items-center gap-1 uppercase">
                                            ROBOSTREAKS
                                        </h3>
                                        <p class="text-[9px] text-slate-500 uppercase tracking-widest font-bold mt-1">Club Membership</p>
                                    </div>
                                </div>
                                <div class="px-3 py-1 rounded-full border border-green-400 bg-green-100 text-[9px] font-extrabold text-green-800 uppercase tracking-widest shadow-sm">
                                    ACTIVE
                                </div>
                            </div>

                            <div class="flex gap-6 items-start flex-1">
                                <div class="flex-shrink-0">
                                    <div class="w-20 h-20 rounded-full bg-slate-100 border-4 border-white shadow-xl ring-2 ring-blue-600/70 flex items-center justify-center relative overflow-hidden">
                                        <div class="text-4xl font-serif font-bold text-slate-700">${initial}</div>
                                        <div class="absolute top-0 left-0 w-full h-1/2 bg-white/30"></div>
                                    </div>
                                </div>

                                <div class="flex-1 min-w-0 pt-1 space-y-2">
                                    <div>
                                        <h1 class="text-xl sm:text-xl font-extrabold text-slate-900 leading-tight truncate">${user.name}</h1>
                                        <div class="flex items-center gap-1.5 text-blue-700 mt-1">
                                            <i data-lucide="layers" class="w-3.5 h-3.5"></i>
                                            <p class="text-[11px] sm:text-xs font-extrabold uppercase tracking-wide truncate">${user.branch || 'General Member'}</p>
                                        </div>
                                    </div>
                                    <div class="space-y-2">
                                        <div class="flex items-center gap-2 text-slate-700">
                                            <i data-lucide="phone" class="w-3.5 h-3.5 shrink-0"></i>
                                            <p class="text-[11px] sm:text-xs font-semibold truncate">${user.mobile || '+1 (555) 000-0000'}</p>
                                        </div>
                                        <div class="flex items-center gap-2 text-slate-700">
                                            <i data-lucide="mail" class="w-3.5 h-3.5 shrink-0"></i>
                                            <p class="text-[11px] sm:text-xs font-semibold truncate">${user.email}</p>
                                        </div>
                                        <div class="flex items-center gap-2 text-slate-700">
                                            <i data-lucide="hash" class="w-3.5 h-3.5 shrink-0"></i>
                                            <p class="text-[11px] sm:text-xs font-mono font-extrabold truncate tracking-widest">${user.regNo || 'PENDING'}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-2 pt-4 border-t-2 border-slate-100 flex justify-between items-end text-[10px] text-slate-500 font-semibold uppercase tracking-widest">
                                <div>Issued: ${user.joinedDate || '2024'}</div>
                                <div class="flex items-center gap-1.5"><span class="w-2 h-2 bg-blue-500 rounded-full"></span> Official Club Identity</div>
                            </div>
                            <div class="absolute right-0 bottom-0 w-36 h-36 bg-blue-50 rounded-tl-full opacity-60 pointer-events-none -z-0"></div>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        // 5. ADMIN DASHBOARD
        function AdminDashboardView() {
            const { search, selectedIds } = state.admin;
            const filtered = getFilteredMembers();
            const colors = ['bg-blue-100 text-blue-700', 'bg-emerald-100 text-emerald-700', 'bg-purple-100 text-purple-700', 'bg-amber-100 text-amber-700', 'bg-rose-100 text-rose-700'];

            const isAllSelected = filtered.length > 0 && filtered.every(m => selectedIds.includes(m.id));

            return `
            <div class="max-w-7xl mx-auto pb-12 animate-fade-in">
                <div class="flex flex-col md:flex-row md:items-end justify-between gap-6 mb-8">
                    <div>
                         <h1 class="text-3xl font-extrabold text-slate-900 tracking-tight">Member Directory</h1>
                        <p class="text-slate-500 text-sm mt-1 max-w-lg">Manage club access permissions, view registration details, and handle communications.</p>
                    </div>
                    
                    <div class="flex gap-3">
                        <button class="px-4 py-2 rounded-lg text-xs font-bold flex items-center gap-2 border border-slate-200 bg-white text-slate-600 hover:bg-slate-50 transition-colors shadow-sm">
                            <i data-lucide="download" class="w-3.5 h-3.5"></i>
                            Export Data
                        </button>
                        <button onclick="actions.handleBulkMail()" ${selectedIds.length === 0 ? 'disabled' : ''}
                            class="px-4 py-2 rounded-lg text-xs font-bold flex items-center gap-2 shadow-md transition-all ${selectedIds.length > 0 ? 'bg-blue-600 hover:bg-blue-700 text-white ring-2 ring-blue-600/20' : 'bg-slate-100 text-slate-400 cursor-not-allowed shadow-none'}">
                            <i data-lucide="mail" class="w-3.5 h-3.5"></i>
                            Compose Mail ${selectedIds.length > 0 ? `<span class="bg-white/20 px-1.5 py-0.5 rounded text-[10px] ml-1">${selectedIds.length}</span>` : ''}
                        </button>
                    </div>
                </div>

                <div class="bg-white p-1.5 rounded-xl border border-slate-200 shadow-sm mb-6 flex items-center gap-2">
                    <div class="relative flex-1">
                        <i data-lucide="search" class="absolute left-3.5 top-1/2 -translate-y-1/2 text-slate-400 w-4 h-4"></i>
                        <input id="search-input" type="text" placeholder="Search directory..." value="${search}" oninput="actions.searchAdmin(this.value)"
                            class="w-full pl-10 pr-4 py-2.5 bg-transparent rounded-lg text-sm focus:outline-none focus:bg-slate-50 transition-all font-medium text-slate-700 placeholder:text-slate-400" />
                    </div>
                    <div class="h-6 w-px bg-slate-200 mx-1"></div>
                    <button class="p-2 text-slate-500 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors">
                        <i data-lucide="filter" class="w-4 h-4"></i>
                    </button>
                </div>

                <div class="bg-white border border-slate-200 rounded-xl shadow-xl shadow-slate-200/40 overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-left border-collapse">
                            <thead>
                                <tr class="bg-slate-50/80 border-b border-slate-200 text-[11px] uppercase text-slate-500 font-bold tracking-wider">
                                    <th class="px-6 py-4 w-12">
                                       <div class="flex items-center justify-center">
                                            <input type="checkbox" onchange="actions.toggleSelectAll()" ${isAllSelected ? 'checked' : ''}
                                                class="w-4 h-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500 focus:ring-offset-0 cursor-pointer" />
                                      </div>
                                    </th>
                                    <th class="px-6 py-4 cursor-pointer hover:bg-slate-100/50 transition-colors group">
                                        <div class="flex items-center gap-2">
                                            Member
                                            <i data-lucide="arrow-up-down" class="w-3 h-3 text-slate-300 group-hover:text-slate-500"></i>
                                        </div>
                                    </th>
                                    <th class="px-6 py-4">Reg. ID</th>
                                    <th class="px-6 py-4">Branch</th>
                                    <th class="px-6 py-4">Status</th>
                                    <th class="px-6 py-4 text-right">Action</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100">
                                ${filtered.length > 0 ? filtered.map((m, idx) => `
                                    <tr class="transition-all duration-200 group ${selectedIds.includes(m.id) ? 'bg-blue-50/60' : 'hover:bg-slate-50'}">
                                        <td class="px-6 py-4">
                                             <div class="flex items-center justify-center">
                                                <input type="checkbox" onchange="actions.toggleSelect('${m.id}')" ${selectedIds.includes(m.id) ? 'checked' : ''}
                                                    class="w-4 h-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500 focus:ring-offset-0 cursor-pointer" />
                                            </div>
                                        </td>
                                        <td class="px-6 py-4">
                                            <div class="flex items-center gap-3">
                                                <div class="w-8 h-8 rounded-lg flex items-center justify-center font-bold text-xs ${colors[idx % colors.length]} shrink-0 shadow-sm">
                                                    ${m.name.charAt(0).toUpperCase()}
                                                </div>
                                                <div>
                                                    <div class="font-bold text-slate-900 text-sm group-hover:text-blue-700 transition-colors">${m.name}</div>
                                                    <div class="text-xs text-slate-400 font-mono mt-0.5">${m.email}</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4">
                                            <span class="font-mono text-xs font-medium text-slate-600 bg-slate-100 px-2 py-1 rounded border border-slate-200">${m.regNo}</span>
                                        </td>
                                        <td class="px-6 py-4 text-sm text-slate-600 font-medium">${m.branch}</td>
                                        <td class="px-6 py-4">
                                            <div class="flex items-center gap-1.5">
                                                <span class="relative flex h-2 w-2">
                                                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                                                    <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                                                </span>
                                                <span class="text-xs font-bold text-slate-700">Active</span>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 text-right">
                                            <button class="text-slate-400 hover:text-slate-800 p-1 rounded hover:bg-slate-200/50 transition-colors">
                                                <i data-lucide="more-horizontal" class="w-4 h-4"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `).join('') : `
                                    <tr>
                                        <td colspan="6" class="px-6 py-20 text-center">
                                            <div class="flex flex-col items-center gap-4">
                                                <div class="w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center border border-slate-100">
                                                    <i data-lucide="users" class="w-8 h-8 text-slate-300"></i>
                                                </div>
                                                <div>
                                                    <p class="text-slate-900 font-bold">No members found</p>
                                                    <p class="text-slate-500 text-sm mt-1">Try adjusting your search query</p>
                                                </div>
                                                <button onclick="actions.searchAdmin('')" class="text-xs text-blue-600 font-bold hover:underline bg-blue-50 px-3 py-1.5 rounded-full mt-2">Clear Filters</button>
                                            </div>
                                        </td>
                                    </tr>
                                `}
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="bg-slate-50 border-t border-slate-200 px-6 py-3 flex items-center justify-between">
                        <p class="text-[10px] uppercase font-bold text-slate-400 tracking-wider">Showing ${filtered.length} records</p>
                        <div class="flex gap-1">
                            <button disabled class="px-2 py-1 text-xs font-bold text-slate-400 bg-white border border-slate-200 rounded shadow-sm opacity-50 cursor-not-allowed">Prev</button>
                            <button class="px-2 py-1 text-xs font-bold text-slate-600 bg-white border border-slate-200 rounded shadow-sm hover:border-slate-300">Next</button>
                        </div>
                    </div>
                </div>
            </div>`;
        }
        
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>
